{% extends 'base.html' %}
{% load static %}
{% block title %}Home - Beta Lab{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{% static "css/home.css" %} ">
{% endblock %}

{% block header_content %}
<div class="hero">
    <div class="hero-content">
        <h1 class="hero-title">  Beta Lab</h1>
        <p class="hero-subtitle"> computer science research laboratory and technological innovations</p>
        <div class="hero-buttons">
            <a href="{% url 'labo:liste_presentations' %}" class="btn btn-primary">Discover our work</a>
            <a href="{% url 'labo:contact' %}" class="btn btn-secondary">Contact us</a>
        </div>
    </div>
</div>
{% endblock %}

{% block content %}
<!-- Section événements -->
<section class="events-section">
    <div class="container">
        <h2 class="section-title">Upcoming Events</h2>
        <div class="events-grid">
            {% for evenement in evenements %}
            <div class="event-card">
                <div class="event-date">
                    <span class="day">{{ evenement.date_debut|date:"d" }}</span>
                    <span class="month">{{ evenement.date_debut|date:"M" }}</span>
                </div>
                <div class="event-details">
                    <h3>{{ evenement.titre }}</h3>
                    <div class="event-info">
                        <span class="event-time"><i class="far fa-clock"></i> {{ evenement.date_debut|date }} - {{ evenement.date_fin|date }}</span>
                        <span class="event-location"><i class="fas fa-map-marker-alt"></i> {{ evenement.lieu }}</span>
                    </div>
                    <p class="event-description">{{ evenement.description|truncatechars:120 }}</p>
                    <span class="event-type">{{ evenement.type_evenement }}</span>
                </div>
            </div>
            {% empty %}
            <div class="empty-message">
                <p>No upcoming events are planned at the moment.</p>
            </div>
            {% endfor %}
        </div>
    </div>
</section>

<!-- SOLUTION SIMPLE ET EFFICACE -->

<section class="domains-section">
    <div class="container">
        <h2 class="section-title">Research Areas</h2>
        <div class="domains-grid">
            {% for theme in themes %}
            <div class="domain-card">
                <div class="domain-icon">
                    <!-- Solution simple basée sur forloop.counter -->
                    {% if forloop.counter == 1 or forloop.counter == 8 or forloop.counter == 15 %}
                        <i class="fas fa-laptop-code"></i>
                    {% elif forloop.counter == 2 or forloop.counter == 9 or forloop.counter == 16 %}
                        <i class="fas fa-microchip"></i>
                    {% elif forloop.counter == 3 or forloop.counter == 10 or forloop.counter == 17 %}
                        <i class="fas fa-brain"></i>
                    {% elif forloop.counter == 4 or forloop.counter == 11 or forloop.counter == 18 %}
                        <i class="fas fa-cloud"></i>
                    {% elif forloop.counter == 5 or forloop.counter == 12 or forloop.counter == 19 %}
                        <i class="fas fa-database"></i>
                    {% elif forloop.counter == 6 or forloop.counter == 13 or forloop.counter == 20 %}
                        <i class="fas fa-network-wired"></i>
                    {% else %}
                        <i class="fas fa-code-branch"></i>
                    {% endif %}
                </div>
                <h3>{{ theme.nom }}</h3>
                <p>{{ theme.description|truncatechars:100 }}</p>
            </div>
            {% empty %}
            <div class="empty-message">
                <p>No research areas are defined at the moment.</p>
            </div>
            {% endfor %}
        </div>
    </div>
</section>
{% if projets_recents %}
<section class="projects-home-section">
    <div class="container">
        <div class="section-header">
            <h2 class="section-title">
                <span class="title-icon"><i class="fas fa-project-diagram"></i></span>
                Our Current Projects
            </h2>
            <p class="section-subtitle">Discover our latest research and development projects</p>
        </div>
        
        <div class="projects-home-grid">
            {% for projet in projets_recents %}
                <div class="project-home-card">
                    <div class="project-home-image">
                        {% if projet.image_principale %}
                            <img src="{{ projet.image_principale.url }}" alt="{{ projet.titre }}">
                        {% else %}
                            <div class="project-home-placeholder">
                                <i class="fas fa-project-diagram"></i>
                            </div>
                        {% endif %}
                        <div class="project-home-status">
                            <i class="fas fa-play"></i> In Progress
                        </div>
                    </div>
                    
                    <div class="project-home-content">
                        <div class="project-home-theme">{{ projet.theme.nom }}</div>
                        <h3 class="project-home-title">{{ projet.titre }}</h3>
                        <p class="project-home-description">{{ projet.description|truncatechars:120 }}</p>
                        
                        <!-- ✅ SECTION RESPONSABLE SUPPRIMÉE -->
                        
                        <a href="{% url 'labo:projet_detail' projet.id %}" class="project-home-link">
                            Learn more <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
            {% endfor %}
        </div>
        
        <div class="section-action">
            <a href="{% url 'labo:liste_projets' %}" class="btn btn-primary btn-lg">
                <i class="fas fa-project-diagram"></i> View all our projects
            </a>
        </div>
    </div>
</section>
{% endif %}

{% if derniers_articles%}
<!-- Section actualités récentes -->
<section class="news-section">
    <div class="container">
        <h2 class="section-title">Recent News</h2>
        <div class="news-grid">
            {% for article in derniers_articles %}
            <article class="news-card">
                <div class="news-image">
                    {% if article.image_principale %}
                    <img src="{{ article.image_principale.url }}" alt="{{ article.titre }}">
                    {% else %}
                    <div class="placeholder-image">
                        <i class="far fa-newspaper"></i>
                    </div>
                    {% endif %}
                </div>
                <div class="news-content">
                    <div class="news-meta">
                        <span class="news-date">{{ article.date_creation|date:"d F Y" }}</span>
                        {% for categorie in article.categories.all|slice:":2" %}
                        <span class="news-category">{{ categorie.nom }}</span>
                        {% endfor %}
                    </div>
                    <h3 class="news-title">{{ article.titre }}</h3>
                    <div class="news-excerpt">
                        {{ article.contenu|striptags|truncatewords:20 }}
                    </div>
                </div>
                <div class="news-footer">
                    <div class="news-author">
                        {% if article.auteur.photo %}
                        <img src="{{ article.auteur.photo.url }}" alt="{{ article.auteur.user.first_name }} {{ article.auteur.user.last_name }}">
                        {% else %}
                        <div class="default-avatar">{{ article.auteur.user.first_name|first }}{{ article.auteur.user.last_name|first }}</div>
                        {% endif %}
                        <span>{{ article.auteur.user.first_name }} {{ article.auteur.user.last_name }}</span>
                    </div>
                    <a href="{% url 'labo:article_detail' article.id %}" class="btn-read">Read more</a>
                </div>
            </article>
            {% empty %}
            <div class="empty-message">
                <p>No articles are available at the moment.</p>
            </div>
            {% endfor %}
        </div>
        <div class="section-action">
            <a href="{% url 'labo:liste_articles' %}" class="btn btn-primary">View all articles</a>
        </div>
    </div>
</section>
{% endif %}

<!-- Section directeurs -->
<section class="team-section director-section">
    <div class="container">
        <h2 class="section-title">Laboratory Management</h2>
        <div class="team-grid">
            {% for membre in membres1 %}
                {% if membre.titre == 'Directeur' or membre.titre == 'Directrice' or membre.user.first_name == 'ALain' or membre.user.last_name == 'TCHANA' or membre.user.first_name == 'Parfait' or membre.user.last_name == 'Bessala' %}
                <div class="team-card">
                    <div class="team-photo">
                        {% if membre.photo %}
                        <img src="{{ membre.photo.url }}" alt="{{ membre.user.first_name }} {{ membre.user.last_name }}">
                        {% else %}
                        <div class="default-avatar">{{ membre.user.first_name|first }}{{ membre.user.last_name|first }}</div>
                        {% endif %}
                    </div>
                    <div class="team-info">
                        <h3>{{ membre.user.first_name }} {{ membre.user.last_name }}</h3>
                        <p class="team-title">{{ membre.titre }}</p>
                        {% if membre.theme %}
                        <p class="team-theme">{{ membre.theme.nom }}</p>
                        {% endif %}
                        <div class="team-social">
                            {% if membre.linkedin %}
                            <a href="{{ membre.linkedin }}" target="_blank" class="social-link"><i class="fab fa-linkedin-in"></i></a>
                            {% endif %}
                            {% if membre.github %}
                            <a href="{{ membre.github }}" target="_blank" class="social-link"><i class="fab fa-github"></i></a>
                            {% endif %}
                            {% if membre.portfolio %}
                            <a href="{{ membre.portfolio }}" target="_blank" class="social-link"><i class="fas fa-globe"></i></a>
                            {% endif %}
                        </div>
                    </div>
                    <a href="{% url 'labo:membre_detail' membre.id %}" class="team-link"></a>
                </div>
                {% endif %}
            {% endfor %}
        </div>
        <div class="section-action">
            <a href="{% url 'labo:responsables' %}" class="btn btn-primary">View all laboratory managers</a>
        </div>
    </div>
</section>

<!-- Section équipe (sans les directeurs) -->
<section class="team-section">
    <div class="container">
        <h2 class="section-title"> Students</h2>
        <div class="team-grid">
            {% for membre in membres|slice:":3" %}
                {% if not membre.titre == 'Directeur' and not membre.titre == 'Directrice' and not membre.user.first_name == 'ALain' and not membre.user.last_name == 'TCHANA' and not membre.user.first_name == 'Parfait' and not membre.user.last_name == 'Bessala' %}
                <div class="team-card">
                    <div class="team-photo">
                        {% if membre.photo %}
                        <img src="{{ membre.photo.url }}" alt="{{ membre.user.first_name }} {{ membre.user.last_name }}">
                        {% else %}
                        <div class="default-avatar">{{ membre.user.first_name|first }}{{ membre.user.last_name|first }}</div>
                        {% endif %}
                    </div>
                    <div class="team-info">
                        <h3>{{ membre.user.first_name }} {{ membre.user.last_name }}</h3>
                        <p class="team-title">{{ membre.titre }}</p>
                        <p class="team-theme">{{ membre.theme.nom }}</p>
                        <div class="team-social">
                            {% if membre.linkedin %}
                            <a href="{{ membre.linkedin }}" target="_blank" class="social-link"><i class="fab fa-linkedin-in"></i></a>
                            {% endif %}
                            {% if membre.github %}
                            <a href="{{ membre.github }}" target="_blank" class="social-link"><i class="fab fa-github"></i></a>
                            {% endif %}
                            {% if membre.portfolio %}
                            <a href="{{ membre.portfolio }}" target="_blank" class="social-link"><i class="fas fa-globe"></i></a>
                            {% endif %}
                        </div>
                    </div>
                    <a href="{% url 'labo:membre_detail' membre.id %}" class="team-link"></a>
                </div>
                {% endif %}
            {% empty %}
                <div class="empty-message">
                    <p>No members are available at the moment.</p>
                </div>
            {% endfor %}
        </div>
        <div class="section-action">
            <a href="{% url 'labo:team' %}" class="btn btn-primary">View all Students</a>
        </div>
    </div>
</section>

<!-- Section statistiques -->
<section class="stats-section">
    <div class="container">
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-number" data-count="{{ nb_membres }}">0</div>
                <div class="stat-label">Researchers</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" data-count="{{ nb_publications }}">0</div>
                <div class="stat-label">Presentations</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" data-count="{{ nb_projets }}">0</div>
                <div class="stat-label">Blogs</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" data-count="{{ nb_partenaires }}">0</div>
                <div class="stat-label">Collaborators</div>
            </div>
        </div>
    </div>
</section>

<!-- Section contact rapide -->
<section class="contact-cta-section">
    <div class="container">
        <div class="contact-cta-content">
            <h2>Interested in our research?</h2>
            <p>Don't hesitate to contact us to learn more about our activities or to discuss a potential collaboration.</p>
            <a href="{% url 'labo:contact' %}" class="btn btn-primary">Contact us</a>
        </div>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script src="{% static "js/home.js" %} "></script>
{% endblock %}